package day16

import org.scalatest.wordspec.AnyWordSpec

class PacketDecoderTest extends AnyWordSpec {

  "Packer Decoder" should {
    "solve samples" in {
      val hexString1 = "D2FE28"

      val packet1 = PacketDecoder.parseHexPacket(hexString1)
      val packetVersion1 = PacketDecoder.versionNumberSum(packet1)

      assert(packetVersion1 == 6)

      val hexString2 = "38006F45291200"

      val packet2 = PacketDecoder.parseHexPacket(hexString2)
      val packetVersion2 = PacketDecoder.versionNumberSum(packet2)

      assert(packetVersion2 == 1 + 6 + 2)

      val hexString3 = "EE00D40C823060"
      val packet3 = PacketDecoder.parseHexPacket(hexString3)
      val packetVersion3 = PacketDecoder.versionNumberSum(packet3)

      assert(packetVersion3 == 7 + 2 + 4 + 1)

      val hexString4 = "8A004A801A8002F478"
      val packet4 = PacketDecoder.parseHexPacket(hexString4)
      val packetVersion4 = PacketDecoder.versionNumberSum(packet4)

      assert(packetVersion4 == 16)

      val hexString5 = "620080001611562C8802118E34"
      val packet5 = PacketDecoder.parseHexPacket(hexString5)
      val packetVersion5 = PacketDecoder.versionNumberSum(packet5)

      assert(packetVersion5 == 12)

      val hexString6 = "C0015000016115A2E0802F182340"
      val packet6 = PacketDecoder.parseHexPacket(hexString6)
      val packetVersion6 = PacketDecoder.versionNumberSum(packet6)

      assert(packetVersion6 == 23)

      val hexString7 = "A0016C880162017C3686B18A3D4780"
      val packet7 = PacketDecoder.parseHexPacket(hexString7)
      val packetVersion7 = PacketDecoder.versionNumberSum(packet7)

      assert(packetVersion7 == 31)
    }

    "convert hex to binary" in {
      val hexString = "38006F45291200"
      val binaryString = PacketDecoder.hexToBinary(hexString)
      println(binaryString == "00111000000000000110111101000101001010010001001000000000")
    }

    "solve part1" in {
      val hexString = "220D6448300428021F9EFE668D3F5FD6025165C00C602FC980B45002A40400B402548808A310028400C001B5CC00B10029C0096011C0003C55003C0028270025400C1002E4F19099F7600142C801098CD0761290021B19627C1D3007E33C4A8A640143CE85CB9D49144C134927100823275CC28D9C01234BD21F8144A6F90D1B2804F39B972B13D9D60939384FE29BA3B8803535E8DF04F33BC4AFCAFC9E4EE32600C4E2F4896CE079802D4012148DF5ACB9C8DF5ACB9CD821007874014B4ECE1A8FEF9D1BCC72A293A0E801C7C9CA36A5A9D6396F8FCC52D18E91E77DD9EB16649AA9EC9DA4F4600ACE7F90DFA30BA160066A200FC448EB05C401B8291F22A2002051D247856600949C3C73A009C8F0CA7FBCCF77F88B0000B905A3C1802B3F7990E8029375AC7DDE2DCA20C2C1004E4BE9F392D0E90073D31634C0090667FF8D9E667FF8D9F0C01693F8FE8024000844688FF0900010D8EB0923A9802903F80357100663DC2987C0008744F8B5138803739EB67223C00E4CC74BA46B0AD42C001DE8392C0B0DE4E8F660095006AA200EC198671A00010E87F08E184FCD7840289C1995749197295AC265B2BFC76811381880193C8EE36C324F95CA69C26D92364B66779D63EA071008C360098002191A637C7310062224108C3263A600A49334C19100A1A000864728BF0980010E8571EE188803D19A294477008A595A53BC841526BE313D6F88CE7E16A7AC60401A9E80273728D2CC53728D2CCD2AA2600A466A007CE680E5E79EFEB07360041A6B20D0F4C021982C966D9810993B9E9F3B1C7970C00B9577300526F52FCAB3DF87EC01296AFBC1F3BC9A6200109309240156CC41B38015796EABCB7540804B7C00B926BD6AC36B1338C4717E7D7A76378C85D8043F947C966593FD2BBBCB27710E57FDF6A686E00EC229B4C9247300528029393EC3BAA32C9F61DD51925AD9AB2B001F72B2EE464C0139580D680232FA129668"
      val packet = PacketDecoder.parseHexPacket(hexString)
      val packetVersionSum = PacketDecoder.versionNumberSum(packet)
      val totalValue = PacketDecoder.getValue(packet)
      println(packetVersionSum)
      println(totalValue)
    }

    "solve part2" in {
      val hexString = "220D6448300428021F9EFE668D3F5FD6025165C00C602FC980B45002A40400B402548808A310028400C001B5CC00B10029C0096011C0003C55003C0028270025400C1002E4F19099F7600142C801098CD0761290021B19627C1D3007E33C4A8A640143CE85CB9D49144C134927100823275CC28D9C01234BD21F8144A6F90D1B2804F39B972B13D9D60939384FE29BA3B8803535E8DF04F33BC4AFCAFC9E4EE32600C4E2F4896CE079802D4012148DF5ACB9C8DF5ACB9CD821007874014B4ECE1A8FEF9D1BCC72A293A0E801C7C9CA36A5A9D6396F8FCC52D18E91E77DD9EB16649AA9EC9DA4F4600ACE7F90DFA30BA160066A200FC448EB05C401B8291F22A2002051D247856600949C3C73A009C8F0CA7FBCCF77F88B0000B905A3C1802B3F7990E8029375AC7DDE2DCA20C2C1004E4BE9F392D0E90073D31634C0090667FF8D9E667FF8D9F0C01693F8FE8024000844688FF0900010D8EB0923A9802903F80357100663DC2987C0008744F8B5138803739EB67223C00E4CC74BA46B0AD42C001DE8392C0B0DE4E8F660095006AA200EC198671A00010E87F08E184FCD7840289C1995749197295AC265B2BFC76811381880193C8EE36C324F95CA69C26D92364B66779D63EA071008C360098002191A637C7310062224108C3263A600A49334C19100A1A000864728BF0980010E8571EE188803D19A294477008A595A53BC841526BE313D6F88CE7E16A7AC60401A9E80273728D2CC53728D2CCD2AA2600A466A007CE680E5E79EFEB07360041A6B20D0F4C021982C966D9810993B9E9F3B1C7970C00B9577300526F52FCAB3DF87EC01296AFBC1F3BC9A6200109309240156CC41B38015796EABCB7540804B7C00B926BD6AC36B1338C4717E7D7A76378C85D8043F947C966593FD2BBBCB27710E57FDF6A686E00EC229B4C9247300528029393EC3BAA32C9F61DD51925AD9AB2B001F72B2EE464C0139580D680232FA129668"
      val packet = PacketDecoder.parseHexPacket(hexString)
      val totalValue = PacketDecoder.getValue(packet)
      println(totalValue)
    }

  }
}
